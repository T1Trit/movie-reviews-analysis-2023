"""
–û—Å–Ω–æ–≤–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ Telegram –±–æ—Ç–∞.
–ö–æ–º–∞–Ω–¥—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, –ø–æ–º–æ—â–∏ –∏ —Å—Ç–∞—Ç—É—Å–∞.
"""

from aiogram import Router, F
from aiogram.types import Message, InlineKeyboardButton, InlineKeyboardMarkup
from aiogram.filters import Command, CommandStart
from loguru import logger

# –ò–º–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤
import sys
from pathlib import Path
sys.path.insert(0, str(Path(__file__).parent.parent.parent))

from config import get_config
from bot.services.sentiment_service import get_sentiment_service

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞
basic_router = Router()

@basic_router.message(CommandStart())
async def cmd_start(message: Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start."""
    user_id = message.from_user.id
    user_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    
    logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} ({user_name}) –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞")
    
    welcome_text = f"""üé¨ <b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {user_name}!</b>

–≠—Ç–æ –±–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–∑—ã–≤–æ–≤ –æ —Ñ–∏–ª—å–º–∞—Ö —Å —Å–∞–π—Ç–∞ –ö–∏–Ω–æ–ø–æ–∏—Å–∫.

<b>üî• –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</b>
‚Ä¢ üîç –ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
‚Ä¢ üìä –ê–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π –æ—Ç–∑—ã–≤–æ–≤
‚Ä¢ üìà –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –¥–∏–∞–≥—Ä–∞–º–º
‚Ä¢ ‚òÅÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±–ª–∞–∫–æ–≤ —Å–ª–æ–≤
‚Ä¢ üìã –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

<b>üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:</b>
/help - –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
/demo - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ

<i>–ü—Ä–æ–µ–∫—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ –æ—Ç–∑—ã–≤–æ–≤ —Ñ–∏–ª—å–º–æ–≤ 2023 –≥–æ–¥–∞</i>"""

    # –°–æ–∑–¥–∞–Ω–∏–µ inline-–∫–Ω–æ–ø–æ–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(text="üìñ –ü–æ–º–æ—â—å", callback_data="help"),
            InlineKeyboardButton(text="üéØ –î–µ–º–æ", callback_data="demo")
        ],
        [
            InlineKeyboardButton(text="üìä –°—Ç–∞—Ç—É—Å", callback_data="status"),
            InlineKeyboardButton(text="‚ÑπÔ∏è –û –ø—Ä–æ–µ–∫—Ç–µ", callback_data="about")
        ]
    ])
    
    await message.answer(welcome_text, reply_markup=keyboard)

@basic_router.message(Command("help"))
async def cmd_help(message: Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help."""
    help_text = """üìö <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º –±–æ—Ç–∞</b>

<b>üîç –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>
/start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
/help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
/demo - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

<b>üé¨ –ü–æ–∏—Å–∫ –∏ –∞–Ω–∞–ª–∏–∑:</b>
/search <–Ω–∞–∑–≤–∞–Ω–∏–µ> - –ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤
<i>–ü—Ä–∏–º–µ—Ä: /search –û–ø–ø–µ–Ω–≥–µ–π–º–µ—Ä</i>

/analyze <ID> - –ê–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤ —Ñ–∏–ª—å–º–∞
<i>–ü—Ä–∏–º–µ—Ä: /analyze 1318972</i>

/movie <ID> - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å–º–µ
<i>–ü—Ä–∏–º–µ—Ä: /movie 1318972</i>

<b>üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:</b>
/chart <ID> <—Ç–∏–ø> - –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
‚Ä¢ sentiment - –≥—Ä–∞—Ñ–∏–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π
‚Ä¢ ratings - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫
‚Ä¢ summary - —Å–≤–æ–¥–Ω—ã–π –∞–Ω–∞–ª–∏–∑
<i>–ü—Ä–∏–º–µ—Ä: /chart 1318972 sentiment</i>

/wordcloud <ID> - –û–±–ª–∞–∫–æ —Å–ª–æ–≤ –∏–∑ –æ—Ç–∑—ã–≤–æ–≤
<i>–ü—Ä–∏–º–µ—Ä: /wordcloud 1318972</i>

<b>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</b>
/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞
/status - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

<b>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</b>
/about - –û –ø—Ä–æ–µ–∫—Ç–µ –∏ –∞–≤—Ç–æ—Ä–∞—Ö

<b>üéØ –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</b>
‚Ä¢ –û–ø–ø–µ–Ω–≥–µ–π–º–µ—Ä - ID: 1318972
‚Ä¢ –ë–∞—Ä–±–∏ - ID: 1202258
‚Ä¢ –ß–µ–ª–æ–≤–µ–∫-–ø–∞—É–∫ - ID: 1143242

<i>üí° –°–æ–≤–µ—Ç: –ù–∞—á–Ω–∏—Ç–µ —Å /demo –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏!</i>"""

    await message.answer(help_text)

@basic_router.message(Command("demo"))
async def cmd_demo(message: Message):
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –±–æ—Ç–∞."""
    demo_text = """üéØ <b>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –±–æ—Ç–∞</b>

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–º –∞–Ω–∞–ª–∏–∑ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Ñ–∏–ª—å–º–∞ "–û–ø–ø–µ–Ω–≥–µ–π–º–µ—Ä" (2023):

<b>üîç –ß—Ç–æ –º—ã –º–æ–∂–µ–º –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:</b>
‚Ä¢ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –∑—Ä–∏—Ç–µ–ª–µ–π (–ø–æ–∑–∏—Ç–∏–≤/–Ω–µ–≥–∞—Ç–∏–≤/–Ω–µ–π—Ç—Ä–∞–ª)
‚Ä¢ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ (1-10)
‚Ä¢ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–ª–æ–≤–∞ –≤ –æ—Ç–∑—ã–≤–∞—Ö
‚Ä¢ –í—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É –º–Ω–µ–Ω–∏–π

<b>üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:</b>
‚Ä¢ –ö—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π
‚Ä¢ –°—Ç–æ–ª–±—á–∞—Ç—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
‚Ä¢ –û–±–ª–∞–∫–∞ —Å–ª–æ–≤
‚Ä¢ –°–≤–æ–¥–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã

<b>üé¨ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:</b>"""

    # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(
                text="üìä –ê–Ω–∞–ª–∏–∑: –û–ø–ø–µ–Ω–≥–µ–π–º–µ—Ä", 
                callback_data="demo_analyze_1318972"
            )
        ],
        [
            InlineKeyboardButton(
                text="üìà –ì—Ä–∞—Ñ–∏–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π", 
                callback_data="demo_chart_1318972_sentiment"
            ),
            InlineKeyboardButton(
                text="‚òÅÔ∏è –û–±–ª–∞–∫–æ —Å–ª–æ–≤", 
                callback_data="demo_wordcloud_1318972"
            )
        ],
        [
            InlineKeyboardButton(
                text="üé¨ –î—Ä—É–≥–∏–µ —Ñ–∏–ª—å–º—ã", 
                callback_data="demo_other_movies"
            )
        ]
    ])
    
    await message.answer(demo_text, reply_markup=keyboard)

@basic_router.message(Command("status"))
async def cmd_status(message: Message):
    """–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏."""
    config = get_config()
    sentiment_service = get_sentiment_service(config)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    data_status = "‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω—ã" if sentiment_service.load_existing_data() else "‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω—ã"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø—Ä–æ–µ–∫—Ç–æ–º
    project_files_exist = all([
        config.project_root.exists(),
        (config.project_root / "data").exists(),
        (config.project_root / "notebooks").exists(),
        (config.project_root / "app").exists()
    ])
    
    integration_status = "‚úÖ –ê–∫—Ç–∏–≤–Ω–∞" if project_files_exist else "‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–∞—è"
    
    status_text = f"""üìä <b>–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</b>

<b>ü§ñ Telegram Bot:</b>
‚Ä¢ –í–µ—Ä—Å–∏—è: 1.0 (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
‚Ä¢ –†–µ–∂–∏–º: {'Webhook' if config.webhook_mode else 'Long Polling'}
‚Ä¢ Debug: {'–í–∫–ª—é—á–µ–Ω' if config.debug else '–í—ã–∫–ª—é—á–µ–Ω'}
‚Ä¢ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: {config.logging.level}

<b>üìÇ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–µ–∫—Ç–æ–º:</b>
‚Ä¢ –°—Ç–∞—Ç—É—Å: {integration_status}
‚Ä¢ –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞: {config.project_root.name}
‚Ä¢ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ: {data_status}
‚Ä¢ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ: {'–í–∫–ª—é—á–µ–Ω–æ' if config.cache.enabled else '–í—ã–∫–ª—é—á–µ–Ω–æ'}

<b>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∞–ª–∏–∑–∞:</b>
‚Ä¢ –õ–∏–º–∏—Ç –æ—Ç–∑—ã–≤–æ–≤: {config.kinopoisk.max_reviews}
‚Ä¢ –ó–∞–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤: {config.kinopoisk.delay}—Å
‚Ä¢ –õ–∏–º–∏—Ç –≤ —á–∞—Å: {config.limits.requests_per_hour}

<b>üìä –°–µ—Ä–≤–∏—Å—ã:</b>
‚Ä¢ –ê–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π: ‚úÖ VADER Sentiment
‚Ä¢ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: ‚úÖ matplotlib + seaborn
‚Ä¢ –û–±–ª–∞–∫–∞ —Å–ª–æ–≤: {'‚úÖ wordcloud' if 'wordcloud' in str(sentiment_service) else '‚ö†Ô∏è –ù–µ –¥–æ—Å—Ç—É–ø–Ω–æ'}

<i>–í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏: {message.date.strftime('%H:%M:%S')}</i>"""

    await message.answer(status_text)

@basic_router.message(Command("about"))
async def cmd_about(message: Message):
    """–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ."""
    about_text = """‚ÑπÔ∏è <b>–û –ø—Ä–æ–µ–∫—Ç–µ</b>

<b>üé¨ –ê–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤ —Ñ–∏–ª—å–º–æ–≤ 2023 –≥–æ–¥–∞</b>
–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ —Ñ–∏–ª—å–º–∞–º —Å —Å–∞–π—Ç–∞ –ö–∏–Ω–æ–ø–æ–∏—Å–∫.

<b>üë• –ê–≤—Ç–æ—Ä—ã –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:</b>
‚Ä¢ –ú–µ–∫–µ–¥–∞ –ë–æ–≥–¥–∞–Ω (ID: 466695)
‚Ä¢ –ú–µ—Ä–∫—É—à–µ–≤ –ê–ª–µ–∫—Å–µ–π (ID: 475164)

<b>ü§ñ Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:</b>
‚Ä¢ –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è Telegram API
‚Ä¢ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
‚Ä¢ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π

<b>üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:</b>
‚Ä¢ Python 3.8+ / aiogram 3.x
‚Ä¢ VADER Sentiment Analysis
‚Ä¢ matplotlib, seaborn, wordcloud
‚Ä¢ pandas, numpy, scikit-learn
‚Ä¢ SQLite + –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

<b>üìä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:</b>
‚Ä¢ –ê–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π (VADER)
‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
‚Ä¢ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã
‚Ä¢ –û–±–ª–∞–∫–∞ —Å–ª–æ–≤
‚Ä¢ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã

<b>üîó GitHub:</b>
github.com/T1Trit/movie-reviews-analysis-2023

<b>üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è:</b> MIT

<i>üéØ –°–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∫ –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ—É –∏ –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö!</i>"""

    await message.answer(about_text)

@basic_router.message(Command("stats"))
async def cmd_stats(message: Message):
    """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞."""
    # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    stats_text = """üìà <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</b>

<b>ü§ñ –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</b>
‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
‚Ä¢ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∞–Ω–∞–ª–∏–∑–æ–≤: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
‚Ä¢ –°–æ–∑–¥–∞–Ω–æ –≥—Ä–∞—Ñ–∏–∫–æ–≤: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

<b>üìä –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã:</b>
‚Ä¢ –û–ø–ø–µ–Ω–≥–µ–π–º–µ—Ä (ID: 1318972)
‚Ä¢ –ë–∞—Ä–±–∏ (ID: 1202258)
‚Ä¢ –ß–µ–ª–æ–≤–µ–∫-–ø–∞—É–∫: –ü–∞—É—Ç–∏–Ω–∞ –≤—Å–µ–ª–µ–Ω–Ω—ã—Ö (ID: 1143242)

<b>üéØ –í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</b>
‚Ä¢ –ö–æ–º–∞–Ω–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
‚Ä¢ –ê–Ω–∞–ª–∏–∑–æ–≤ –∑–∞–ø—É—â–µ–Ω–æ: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
‚Ä¢ –ì—Ä–∞—Ñ–∏–∫–æ–≤ —Å–æ–∑–¥–∞–Ω–æ: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

<i>üí° –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö</i>"""

    await message.answer(stats_text)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ inline –∫–Ω–æ–ø–æ–∫
@basic_router.callback_query(F.data == "help")
async def callback_help(callback):
    """Inline –∫–Ω–æ–ø–∫–∞ –ø–æ–º–æ—â–∏."""
    await callback.message.edit_text(
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /help –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π —Å–ø—Ä–∞–≤–∫–∏",
        reply_markup=None
    )
    await callback.answer()

@basic_router.callback_query(F.data == "demo")
async def callback_demo(callback):
    """Inline –∫–Ω–æ–ø–∫–∞ –¥–µ–º–æ."""
    await callback.message.edit_text(
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /demo –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π",
        reply_markup=None
    )
    await callback.answer()

@basic_router.callback_query(F.data == "status")
async def callback_status(callback):
    """Inline –∫–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ç—É—Å–∞."""
    await callback.message.edit_text(
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /status –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã",
        reply_markup=None
    )
    await callback.answer()

@basic_router.callback_query(F.data == "about")
async def callback_about(callback):
    """Inline –∫–Ω–æ–ø–∫–∞ –æ –ø—Ä–æ–µ–∫—Ç–µ."""
    await callback.message.edit_text(
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /about –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–µ–∫—Ç–µ",
        reply_markup=None
    )
    await callback.answer()

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–µ–º–æ-–∫–Ω–æ–ø–æ–∫
@basic_router.callback_query(F.data.startswith("demo_"))
async def callback_demo_commands(callback):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–º–æ-–∫–æ–º–∞–Ω–¥."""
    data = callback.data
    
    if data == "demo_analyze_1318972":
        response = "üé¨ –ó–∞–ø—É—Å—Ç–∏—Ç–µ: /analyze 1318972\n–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∏–ª—å–º–∞ '–û–ø–ø–µ–Ω–≥–µ–π–º–µ—Ä'"
    elif data == "demo_chart_1318972_sentiment":
        response = "üìä –ó–∞–ø—É—Å—Ç–∏—Ç–µ: /chart 1318972 sentiment\n–î–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π"
    elif data == "demo_wordcloud_1318972":
        response = "‚òÅÔ∏è –ó–∞–ø—É—Å—Ç–∏—Ç–µ: /wordcloud 1318972\n–î–ª—è –æ–±–ª–∞–∫–∞ —Å–ª–æ–≤"
    elif data == "demo_other_movies":
        response = """üé¨ <b>–î—Ä—É–≥–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∏–ª—å–º—ã:</b>
        
‚Ä¢ –ë–∞—Ä–±–∏ (2023) - ID: 1202258
  /analyze 1202258
  
‚Ä¢ –ß–µ–ª–æ–≤–µ–∫-–ø–∞—É–∫: –ü–∞—É—Ç–∏–Ω–∞ –≤—Å–µ–ª–µ–Ω–Ω—ã—Ö - ID: 1143242
  /analyze 1143242

üí° –ò–ª–∏ –Ω–∞–π–¥–∏—Ç–µ —Å–≤–æ–π —Ñ–∏–ª—å–º: /search –Ω–∞–∑–≤–∞–Ω–∏–µ"""
    else:
        response = "–ö–æ–º–∞–Ω–¥–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"
    
    await callback.message.edit_text(response, reply_markup=None)
    await callback.answer()

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
@basic_router.message()
async def handle_unknown(message: Message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π."""
    text = message.text.lower() if message.text else ""
    
    if any(word in text for word in ["–ø—Ä–∏–≤–µ—Ç", "hello", "hi", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π"]):
        await message.answer(
            "üëã –ü—Ä–∏–≤–µ—Ç! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /start –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –∏–ª–∏ /help –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏."
        )
    elif any(word in text for word in ["—Å–ø–∞—Å–∏–±–æ", "thanks", "–±–ª–∞–≥–æ–¥–∞—Ä—é"]):
        await message.answer("üòä –ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –†–∞–¥ –ø–æ–º–æ—á—å —Å –∞–Ω–∞–ª–∏–∑–æ–º —Ñ–∏–ª—å–º–æ–≤!")
    elif any(word in text for word in ["—Ñ–∏–ª—å–º", "–∫–∏–Ω–æ", "movie"]):
        await message.answer(
            "üé¨ –î–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–∏–ª—å–º–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: /search –Ω–∞–∑–≤–∞–Ω–∏–µ\n"
            "–ù–∞–ø—Ä–∏–º–µ—Ä: /search –û–ø–ø–µ–Ω–≥–µ–π–º–µ—Ä"
        )
    else:
        await message.answer(
            "ü§î –ù–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.\n"
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥."
        )